# Inverse optimization config (skeleton)
seed_size: 16
struct_size: 128

generator:
  sigma_set: [0.8, 1.0, 1.2]
  tau0: 0.5
  delta_tau: 0.05
  backend: "rule_mfs"
  # rule_mfs knobs (ignored unless backend: rule_mfs)
  sym_mode: "upper_copy"
  threshold_temp: 0.05
  # Approx of MIN_FEATURE_SIZE=10.0 in the original script -> radius ~ 5px.
  mfs_radius_px: 5
  mfs_iters: 4
  mfs_kernel: "soft_circle"
  # Keep it moderately soft to preserve gradients; uniform disk (no distance decay).
  mfs_soft_beta: 30.0
  mfs_dist_scale: 0.0
  # Extra wrap padding before MFS iterations (cropped back). Larger reduces boundary artifacts.
  mfs_pad_mult: 8

spectra:
  n_channels: 30   # or 301
  # Scale RGB spectra before building purity matrix A. Default emphasizes green by 2x.
  rgb_weights:
    R: 1.0
    G: 2.0
    B: 1.0
  band_ranges_nm:
    B: [400.0, 500.0]
    G: [500.0, 600.0]
    R: [600.0, 700.0]
  band_indices_30:
    B: [0, 9]
    G: [10, 19]
    R: [20, 29]

loss:
  epsilon: 1.0e-6
  # Simple default: match purity matrix A to Identity (3x3)
  w_purity: 1.0
  w_abs: 0.0

  # Legacy/advanced (off by default)
  w_ratio: 0.0
  margin_alpha: 0.3
  w_oob: 0.0
  w_gray: 0.1
  w_tv: 0.01

  # Keep fill fraction within surrogate training constraints (CR_recon: sum_min/max).
  # Helps avoid OOD collapse to all-ones/all-zeros.
  w_fill: 1.0
  fill_min: 0.2
  fill_max: 0.5

opt:
  n_start: 200
  n_steps: 2000
  lr: 0.01
  topk: 50
  robustness_samples: 8
  log_every_n_steps: 25
  random_seed: 0
  chunk_size: 64
  loss_reduction: "mean"
  engine: "ga"
  ga_elite: 8
  ga_tournament_k: 5
  ga_crossover_alpha: 0.5
  ga_mutation_sigma: 0.15
  ga_mutation_p: 0.2

paths:
  paths_yaml: "configs/paths.yaml"
